<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="./css/bootstrap.min.css" />
    <!-- FONTAWESOME -->
    <link rel="stylesheet" href="./fonts/fontawesome-free-5.14.0-web/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.9.3/tiny-slider.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />
    <!-- OPTIIONAL CSS -->
    <link rel="stylesheet" href="./css/style.css" />
    <title>Demo - Theme Store Haravan</title>
</head>

<body>
    <!-- TOPBAR -->
    <div class="top-bar bg-dark">
        <div class="container">
            <div class="row justify-content-start align-item">
                <div class="top-bar__contact mr-auto py-2 col-lg-8 d-lg-block d-none small" text-left>
                    <div class="top-bar__hotline d-inline-block">
                        <img src="./img/icondienthoai.png" alt="phone icon" />
                        <b class="text-light">Tư Vấn 24/7:</b><span class="text-muted"> 0909528368</span>
                    </div>
                    <div class="top-bar__address d-inline-block ml-2">
                        <b class="text-light">Địa chỉ:</b><span class="text-muted">
                            P214 , Chung cư B3, Ngõ 118 , Nguyễn Khánh Toàn</span>
                    </div>
                </div>
                <div class="top-bar__user ml-auto col-lg-4 col-12 text-right top-bar__user__account">
                    <div class="account__dropdown py-1 d-inline-block">
                        <a class="btn-sm py-5 text-light text-decoration-none" href="#">
                            <i class="fa fa-user"></i>
                            <span>Tài Khoản</span>
                        </a>
                        <div class="account__dropdown-menu">
                            <a class="btn btn-light d-block" href="./signIn.html">Đăng nhập</a>
                            <a class="btn btn-light d-block" href="./signUp.html">Đăng ký</a>
                        </div>
                    </div>
                    <div class="cart-dropdown py-2 d-lg-inline-block d-none top-bar__user__cart" id="cart">
                        <a class="btn-sm text-light text-decoration-none" id="cartBtn" href="#">
                            <i class="fa fa-shopping-cart"></i>
                            <span>Giỏ Hàng
                                <span id="cartAmount" class="badge badge-light"></span></span>
                        </a>
                        <div class="cart-dropdown__menu">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- HEADER -->
    <header class="container-fluid" id="header" style="background-color: #f4f4f4;">
        <div class="row">
            <!-- NAVIGATION -->
            <div class="col-lg-8 col-12">
                <div class="navbar-container">
                    <nav class="navbar navbar-expand-lg navbar-light">
                        <a class="navbar-brand" href="#">
                            <img src="./img/logo.png" alt="logo" />
                        </a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                            <ul class="navbar-nav mr-auto">
                                <li class="nav-item active">
                                    <a class="nav-link" href="./index.html">Trang chủ </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="./about.html">Giới thiệu</a>
                                </li>
                                <li class="nav-item my-dropdown">
                                    <span></span>
                                    <a class="nav-link" href="/index.html" id="myDropDownBtn">
                                        Sản phẩm
                                        <i class="fa fa-angle-down d-lg-inline-block d-none"></i>
                                    </a>
                                    <div class="my-dropdown-menu product__dropdown-menu rounded mt-2">
                                        <div class="container">
                                            <div class="row">
                                                <div class="col-12 col-md-8">
                                                    <ul class="row">
                                                        <li class="col-sm-6 col-12 py-2">
                                                            <a href="./products.html" class="h6">Phòng khách</a>
                                                            <ul class="list-group-flush">
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Ghế bành</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Bàn tiếp khách</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Tủ cao</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Ghế tựa</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Ghế vuông</a>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                        <li class="col-sm-6 col-12 py-2">
                                                            <a href="./products.html" class="h6">Phòng ngủ</a>
                                                            <ul class="list-group-flush">
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Bàn trang điểm</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Giường ngủ</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Rèm</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Tủ</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Ghế</a>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                        <li class="col-sm-6 col-12 py-2">
                                                            <a href="./products.html" class="h6">Nhà bếp</a>
                                                            <ul class="list-group-flush">
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Bồn rửa</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Tủ bếp</a>
                                                                </li>
                                                                <li class="list-group-item py-1">
                                                                    <a href="./products.html" class="text-muted">Nội thất</a>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                        <li class="col-sm-6 col-12 py-2">
                                                            <a href="./products.html" class="h6">Thiết bị vệ sinh</a>
                                                        </li>
                                                        <li class="col-sm-6 col-12 py-2">
                                                            <a href="./products.html" class="h6">Đồ trang trí</a>
                                                        </li>
                                                        <li class="col-sm-6 col-12 py-2">
                                                            <a href="./products.html" class="h6">Nhà thông minh</a>
                                                        </li>
                                                        <li class="col-sm-6 col-12 py-2">
                                                            <a href="./products.html" class="h6">Sofa</a>
                                                        </li>
                                                        <li class="col-sm-6 col-12 py-2">
                                                            <a href="./products.html" class="h6">Phòng tắm</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="col-12 col-md-4">
                                                    <h6 class="text-success py-2">Sản phẩm nổi bật</h6>
                                                    <div class="d-block best-seller__container">
                                                        <div class="best-seller">
                                                            <div class="row">
                                                                <a href="./productDetail.html" class="col-sm-6 col-12">
                                                                    <img class="w-100 h-100" src="./img/ban_go.jpg" /></a>
                                                                <div class="col-sm-6 col-12 best-seller__info">
                                                                    <div class="h6">
                                                                        Lorem, ipsum
                                                                    </div>
                                                                    <div class="best-seller__price">
                                                                        <span class="price-before text-muted">
                                                                            26,000,000₫
                                                                        </span>
                                                                        19,000,000₫
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="best-seller">
                                                            <div class="row">
                                                                <a href="./productDetail.html" class="col-sm-6 col-12">
                                                                    <img class="w-100 h-100" src="./img/ban_go.jpg" /></a>
                                                                <div class="col-sm-6 col-12 best-seller__info">
                                                                    <div class="h6">
                                                                        Lorem, ipsum
                                                                    </div>
                                                                    <div class="best-seller__price">
                                                                        <span class="price-before text-muted">
                                                                            26,000,000₫
                                                                        </span>
                                                                        19,000,000₫
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="best-seller">
                                                            <div class="row">
                                                                <a href="./productDetail.html" class="col-sm-6 col-12">
                                                                    <img class="w-100 h-100" src="./img/ban_go.jpg" /></a>
                                                                <div class="col-sm-6 col-12 best-seller__info">
                                                                    <div class="h6">
                                                                        Lorem, ipsum
                                                                    </div>
                                                                    <div class="best-seller__price">
                                                                        <span class="price-before text-muted">
                                                                            26,000,000₫
                                                                        </span>
                                                                        19,000,000₫
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#">Thiết kế nội thất</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="./news.html">Tin Tức</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="./contact.html">Liên hệ</a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
            <!--    SEARCH FORM -->
            <form class="form-inline justify-content-lg-end col-lg-4 col-md-12 my-2 my-lg-0">
                <input class="form-control w-50 rounded-0" type="search" id="searchBar" name="q" placeholder="Bạn muốn tìm gì?" maxlength="128" aria-label="Search" />
                <button class="btn btn-success ml-2 my-2 my-sm-0 rounded-0" type="submit">
                    <i class="fa fa-search" aria-hidden="true"></i>
                </button>
            </form>
        </div>
    </header>
    <!-- CART -->
    <section id="customerCart">
        <div class="container">
            <div class="row">
                <div class="products__header">
                    <h3>Giỏ <span style="color: #888;">hàng</span></h3>
                </div>
            </div>
            <div class="row">
                <div class="customerCart__view col-12">
                    <form id="customerCartView" class="form table-responsive" action="/checkout.html" method="get"></form>
                </div>
            </div>
            <div class="row" id="cartView__sumTable">
                <div class="col-12 cartView__sumTable">
                    <table class="table table-bordered">
                        <tbody>
                            <tr>
                                <th scope="row" class="text-success text-uppercase">Giá</th>
                                <td name="sum" class="text-muted"></td>
                            </tr>
                            <tr>
                                <th scope="row" class="text-success text-uppercase">Phí vận chuyển </th>
                                <td class="text-muted">Tính phí khi thanh toán</td>
                            </tr>
                            <tr>
                                <th scope="row" class="text-success text-uppercase">Tổng đơn hàng</th>
                                <td name="sum" class="h2 text-info"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-12 text-center cartView__btn mt-2 d-flex justify-content-center">
                    <a href="./index.html" class="btn btn-success mx-1">Tiếp tục mua hàng</a>
                    <a href="./checkout.html" class="btn btn-success mx-1">Thanh toán</a>
                </div>
            </div>
        </div>
    </section>
    <!-- ADDRESS -->
    <section id="address" class="container">
        <div class="row mt-5">
            <div class="col-md-6 col-12 card bg-success rounded-0 text-light">
                <div class="card-header d-flex justify-content-start align-items-center">
                    <div class="p-1">
                        <img src="./img/icon_shop.png" alt="" />
                    </div>
                    <div class="p-1">
                        <div class="card-title text-uppercase font-italic h4">
                            FLEXSHOP
                        </div>
                        <p class="card-subtitle text-uppercase">
                            Nội thất hiện đại
                        </p>
                    </div>
                </div>
                <div class="card-body">
                    <div class="card-text">
                        <i class="fa fa-map-marker-alt mr-3"></i>
                        <span class="lead">P214 , Chung cư B3, Ngõ 118 , Nguyễn Khánh Toàn</span>
                    </div>
                    <div class="card-text">
                        <i class="fa fa-envelope mr-3"></i>
                        <span>Email:
                            <a href="mailto:songvangvietnam@gmail.com" class="text-light">songvangvietnam@gmail.com</a></span>
                    </div>
                    <div class="card-text">
                        <i class="fa fa-phone mr-3"></i>
                        <span>Phone:
                            <a href="tel:+84902.068.068" class="text-light">0902.068.068</a></span>
                    </div>
                </div>
                <div class="card-footer">
                    <span>FOLLOW US: </span>
                    <a href="#" class="d-inline-block p-1 rounded-circle"><i class="fab fa-facebook text-light"></i></a>
                    <a href="#" class="d-inline-block p-1 rounded-circle"><i class="fab fa-twitter text-light"></i></a>
                    <a href="#" class="d-inline-block p-1 rounded-circle"><i class="fa fa-rss text-light"></i></a>
                    <a href="#" class="d-inline-block p-1 rounded-circle"><i class="fab fa-google-plus text-light"></i></a>
                    <a href="#" class="d-inline-block p-1 rounded-circle"><i class="fab fa-pinterest text-light"></i></a>
                </div>
            </div>
            <div id="mapid" class="col-md-6 col-12"></div>
        </div>
    </section>
    <!-- FOOTER -->
    <footer id="footer" class="footer bg-dark">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-4 col-sm-6 col-12 mt-2">
                    <h5 class="text-light mb-2">Hỗ trợ</h5>
                    <ul>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> TÌm kiếm</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> Tư vấn thiết kế</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> Chăm sóc khách hàng</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> Kiểm tra đơn hàng</a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-4 col-sm-6 col-12 mt-2">
                    <h5 class="text-light mb-2">Hướng dẫn</h5>
                    <ul>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> Hướng dẫn thanh
                                toán</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> giao nhận và thanh
                                toán</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> đổi trả và bảo hành</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> Đăng ký thành viên</a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-4 col-sm-6 col-12 mt-2">
                    <h5 class="text-light mb-2">Chính sách</h5>
                    <ul>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> Chính sách thanh
                                toán</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> chính sách vận
                                chuyển</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> chính sách đổi trả
                            </a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> chính sách bảo hành</a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-4 col-sm-6 col-12 mt-2">
                    <h5 class="text-light mb-2">Tại sao chọn chúng tôi</h5>
                    <ul>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> Đội ngũ chuyên
                                nghiệp</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> giá cả hợp lý</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> kinh nghiệm trên 20
                                năm</a>
                        </li>
                        <li class="d-block">
                            <a href="#" class="text-light"><i class="fa fa-caret-right mr-1"></i> đảm bảo tiến độ</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
    <button id="toTop" class="btn rounded-0">
        <i class="fa fa-angle-up"></i>
    </button>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="./js/jquery-3.5.1.slim.min.js"></script>
    <script src="./js/popper.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tiny-slider/2.9.2/min/tiny-slider.js"></script>
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
    <!-- Optional JavaScript -->
    <script src="./js/app.js"></script>
    <script src="./js/cart.js"></script>
    <script type="text/javascript">
    function showCart() {
        let content = `<table class="table table-bordered">
        <thead>
            <tr>
                <th scope="col" class="text-uppercase text-muted">Ảnh</th>
                <th scope="col" class="text-uppercase text-muted">Tên sản phẩm</th>
                <th scope="col" class="text-uppercase text-muted">Đơn giá</th>
                <th scope="col" class="text-uppercase text-muted">Số lượng</th>
                <th scope="col" class="text-uppercase text-muted">Thành tiền</th>
                <th scope="col" class="text-uppercase text-muted">Xóa</th>
            </tr>
        </thead>
        <tbody>`;
        if (!getAmount(cart)) {
            document.getElementById('cartView__sumTable').style.display = 'none';
            content = "<h1 class='col-12'>Giỏ hàng của bạn hiện đang trống</h1><h1 class='col-12'>Bấm vào<a href='/index.html' class='text-success'> đây </a>để mua hàng</h1>"
        } else {
            document.getElementById('cartView__sumTable').style.display = 'block';
            content += [...cart].map((item) => {
                const name = item[0];
                const { img, price, quantity, totalPrice, description } = item[1];
                return `
                    <tr>
                      <td><img src="${img}" alt="product image" class="h-50 p-2"/></td>
                      <td>${name}<br/>${description || ""}</td>
                      <td>${formatCurrency(price)}</td>
                      <td>
                        <div class="table__updateQuantity">
                                <button class="btn btn-success" name="minus">
                                    <span class="fa fa-minus"></span>
                                </button>                                                            
                      <input type="number" value='${quantity}' name='updateQuantity[]' min='1' class="form-control text-center"/>
                                <button class="btn btn-success" name="plus">
                                    <span class="fa fa-plus"></span>
                                </button>
                        </div>
                      </td>
                      <td>${formatCurrency(totalPrice)}</td>
                      <td><button class="btn btn-danger" name="remove"><span class="fa fa-times"></span></button></td>
                    </tr>`
            }).join('');
        }
        content += '</tbody></table>'
        document.getElementById('customerCartView').innerHTML = content;
        document.querySelectorAll(`td[name='sum']`).forEach(td => td.innerText = formatCurrency(getCost(cart)));
    }

    showCart();


    //UPDATE PRICE EVERY TIME QUANTITY CHANGES

    function updatePriceInView(currentChild) {
        const price = +currentChild.children[2].innerText.replace(/[,|₫]/gi, "");
        const quantity = +currentChild.children[3].children[0].children[1].value;
        const totalPrice = price * quantity;
        currentChild.children[4].innerText = formatCurrency(totalPrice);
        updateCartItem(currentChild);
    }

    //DECREASE QUANTITY BY 1

    document.querySelectorAll("button[name='minus']").forEach((button) => {
        button.addEventListener('click', (event) => {
            event.preventDefault();
            const { value } = event.target.nextElementSibling;
            event.target.nextElementSibling.value = (+value - 1 || 1);
            updatePriceInView(event.target.parentNode.parentNode.parentNode);
        })
    })

    //INCREASE QUANTITY BY 1

    document.querySelectorAll("button[name='plus']").forEach((button) => {
        button.addEventListener('click', (event) => {
            event.preventDefault(event.target.parentNode.parentNode.parentNode);
            const { value } = event.target.previousElementSibling;
            event.target.previousElementSibling.value = (+value + 1);
            updatePriceInView(event.target.parentNode.parentNode.parentNode);
        })
    })

    //REMOVE FROM TABLE AND CART
    document.querySelectorAll("button[name='remove']").forEach((button) => {
        button.addEventListener('click', (event) => {
            event.preventDefault();
            const table = document.getElementsByTagName('tbody')[0];
            removeItem(event.target.parentNode.parentNode.children[1].innerText);
            table.removeChild(event.target.parentNode.parentNode);
        })
    })

    //UPDATE CART 
    function updateCartItem(currentChild) {
        const name = currentChild.querySelector('td:nth-child(2)').innerText;
        const product = {
            img: currentChild.querySelector('td > img').src,
            price: +currentChild.querySelector('td:nth-child(3)').innerText.replace(/[,|₫]/gi, ""),
            quantity: +currentChild.querySelector('input').value,
            totalPrice: +currentChild.querySelector('td:nth-child(5)').innerText.replace(/[,|₫]/gi, ""),
        }

        cart.set(name, product);
        document.querySelectorAll(`td[name='sum']`).forEach(td => td.innerText = formatCurrency(getCost(cart)));
        setCart(cart);
    }
    </script>
</body>

</html>